- name: Install Mlab Processor
  hosts: processor

  tasks:
    - name: Copy binary to host
      become: yes
      ansible.builtin.copy:
        src: ../../../mlab-processor
        dest: /usr/local/bin/mlab-processor
        mode: '0655'
    - name: Copy systemd service file to host
      become: yes
      ansible.builtin.copy:
        src: ./mlab-processor.service
        dest: /etc/systemd/system/mlab-processor.service
        mode: '0644'
    - name: Reload Systemd
      become: yes
      ansible.builtin.systemd:
        daemon_reload: true
        enabled: true
        name: mlab-processor
        state: started
