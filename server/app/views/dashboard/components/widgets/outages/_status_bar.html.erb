<% data = [
  {
    start_date: 1713189937 + ((1713794719 - 1713189937) / 2).floor(0),
    end_date: 1713622026,
    type: 'isp'
  }
] %>
<% today = Time.now %>
<% days = params[:days] ? params[:days].to_i : 30 %>
<% start_date = params[:start].present? ? Time.parse(params[:start]) : Time.parse((today - days.days).to_s) %>
<% end_date = params[:end].present? ? Time.parse(params[:end]) : Time.parse(today.to_s) %>
<div class="dashboard--status-bar" data-controller="outages-chart">
  <% data.each_with_index do |outage, index| %>
    <% full_time_span = (end_date - start_date).to_i %>
    <% width = (outage[:end_date] - outage[:start_date]).to_f / (full_time_span).to_f * 100 %>
    <% left = ((outage[:start_date] - start_date.to_i).to_f / (full_time_span.to_f) * 100).floor(0) %>
    <div class="dashboard--status-outage-bar"
         style="width: <%= width %>%; left: <%= left %>%; border-top-left-radius: <%= left < 1 ? '.25rem' : 0 %>; border-bottom-left-radius: <%= left < 1 ? '.25rem' : 0 %>"
         data-action="mouseenter->outages-chart#hoverOutage mouseleave->outages-chart#unhoverOutage"
         data-outages-chart-target="outage"
         data-tooltip-id="outage-tooltip-<%= index %>"
    >
      <%= render partial: "dashboard/components/widgets/outages/tooltip",
                 locals: {
                   start_date: Time.at(outage[:start_date].to_i),
                   end_date: Time.at(outage[:end_date].to_i),
                   type: outage[:type],
                   index: index
                 }
      %>
    </div>
  <% end %>
</div>
<div class="dashboard--status-dates-container">
  <% jump = (days / 5).floor(0) %>
  <p class="dashboard--status-date-label"><%= start_date.strftime("%b %d") %></p>
  <% (1..4).each_with_index do |index| %>
    <p class="dashboard--status-date-label"><%= (start_date + (index * jump).days).strftime("%b %d") %></p>
  <% end %>
  <p class="dashboard--status-date-label"><%= end_date.strftime("%b %d") %></p>
</div>