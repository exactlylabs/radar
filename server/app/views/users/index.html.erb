<!--begin::Toolbar-->
<div class="toolbar" id="kt_toolbar">
  <div class="d-flex flex-stack flex-wrap flex-sm-nowrap">
    <!--begin::Info-->
    <div class="d-flex flex-column align-items-start justify-content-center flex-wrap me-2">
      <!--begin::Title-->
      <h1 class="page-main-title">Users 
      <small class="text-muted fs-6 fw-normal ms-1"></small></h1>
      <!--end::Title-->
      <!--begin::Breadcrumb-->
      <ul class="breadcrumb fw-bold fs-base my-1">
        <li class="breadcrumb-item page-sub-title"><%= current_account.is_all_accounts? ? "All accounts" : current_account.name %>
        </li>
      </ul>
      <!--end::Breadcrumb-->
    </div>
    <!--end::Info-->
    <div class="d-flex align-items-center flex-nowrap text-nowrap py-1">
      <% if FeatureFlagHelper.is_available('roles', current_user) %>
        <a href="<%= get_add_member_modal_path %>"
           class="custom-button custom-button--primary custom-button--sm"
           data-turbo-frame="invite_member_modal"
        >
          <%= image_tag image_url('white-plus.png'), width: 16, height: 16, class: "me-1" %>
          Add member
        </a>
      <% else %>
        <button
          type="button"
          class="custom-button custom-button--primary custom-button--sm"
          data-bs-toggle="modal"
          data-bs-target="#add_user_wizard"
        >Add User</button>
      <% end %>
    </div>
  </div>
</div>
<!--end::Toolbar-->
<div class="post fs-6 d-flex flex-column" id="kt_post" data-controller="multi-row-table">
  <% if !current_account.is_all_accounts? %>
    <%= render partial: "application/components/tabs/page_tabs",
        locals: {
          tabs: [
            { text: 'Members', path: users_account_index_path },
            { text: 'Account Sharing', path: users_account_shared_path }
          ]
        }
     %>
  <% end %>
  <%= render partial: "users/users_table_filters" %>
  <!--begin::Container-->
  <!-- render partial: "users/users_table", locals: { users_accounts: users_accounts, invited_users: invited_users } -->
  <% table_type = current_account.is_all_accounts? ? TablesHelper::TableTypes::ALL_ACCOUNTS_MEMBERS : TablesHelper::TableTypes::MEMBERS %>
  <%= render partial: "application/components/tables/generic_table",
      locals: {
        table_id: "users_table",
        type: table_type,
        titles: TablesHelper.titles(table_type, current_account.is_all_accounts?),
        widths: TablesHelper.widths(table_type, current_account.is_all_accounts?),
        rows: elements,
        total: total
      }
  %>
  <!--end::Container-->
</div>

<% if FeatureFlagHelper.is_available('roles', current_user) %>
  <%= render partial: "application/components/modals/turbo_modal",
             locals: { turbo_frame_tag_id: "invite_member_modal", optional_added_controllers: "add-user" }
  %>
<% else %>
  <div class="modal fade"
       tabindex="-1"
       id="add_user_wizard"
       data-controller="add-user modal"
       data-action="turbo:submit-end->modal#submit"
  >
    <%= render partial: "users/add_user_wizard/add_user_wizard" %>
  </div>
<% end %>