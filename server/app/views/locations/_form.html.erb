<%= form_with(model: @location, data: {controller: "location-form"}) do |form| %>
  <div class="modal-body">
    <% if location.errors.any? %>
      <div id="error_explanation">
        <h2><%= pluralize(location.errors.count, "error") %> prohibited this location from being saved:</h2>

        <ul>
          <% location.errors.each do |error| %>
            <li><%= error.full_message %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="row">
      <div class="col-lg-6 mb-10 mb-lg-0">
        <div class="fv-row mb-7 fv-plugins-icon-container">
          <!--begin::Label-->
          <label class="required fs-6 fw-bold mb-2">Name</label>
          <!--end::Label-->
          <!--begin::Input-->
          <%= form.text_field :name, class: "form-control form-control-solid", placeholder: 'Your location name' %>
          <!--end::Input-->
          <div class="fv-plugins-message-container invalid-feedback"></div>
        </div>

        <div class="fv-row mb-7 fv-plugins-icon-container">
          <!--begin::Label-->
          <label class="required fs-6 fw-bold mb-2">Address</label>
          <!--end::Label-->
          <!--begin::Input-->
          <%= form.text_field :address, class: "form-control form-control-solid", placeholder: 'Your location address', data: { "location-form-target" => "address", action: "input->location-form#onAddressChange" } %>
          <!--end::Input-->
          <div class="fv-plugins-message-container invalid-feedback"></div>
        </div>

        <div class="fv-row mb-7 fv-plugins-icon-container">
          <div class="form-check form-switch form-check-custom form-check-solid">
            <%= form.check_box :manual_lat_long, class: "form-check-input h-30px w-50px", data: { "location-form-target" => "manual_lat_long", action: "input->location-form#onManuallyChange" } %>
            <label class="form-check-label text-muted fw-bold" for="flexSwitchDefault">
                Adjust coordinates manually
            </label>
          </div>
        </div>

        <div class="row mb-7">
          <div class="col-6 fv-plugins-icon-container">
            <!--begin::Label-->
            <label class="conditional fs-6 fw-bold mb-2 <%= @location.manual_lat_long ? '' : 'text-muted'%>">Latitude</label>
            <!--end::Label-->
            <!--begin::Input-->
            <%= form.text_field :latitude, 
                  class: "conditional form-control form-control-solid #{@location.manual_lat_long ? '' : 'text-muted'}", 
                  readonly: !@location.manual_lat_long, 
                  data: { "location-form-target" => "latitude", action: "input->location-form#onLatitudeChange" } 
            %>
            <!--end::Input-->
            <div class="fv-plugins-message-container invalid-feedback"></div>
          </div>

          <div class="col-6 fv-plugins-icon-container">
            <!--begin::Label-->
            <label class="conditional fs-6 fw-bold mb-2 <%= @location.manual_lat_long ? '' : 'text-muted' %>">Longitude</label>
            <!--end::Label-->
            <!--begin::Input-->
            <%= form.text_field :longitude, 
                  class: "conditional form-control form-control-solid #{@location.manual_lat_long ? '' : 'text-muted'}", 
                  readonly: !@location.manual_lat_long, 
                  data: { "location-form-target" => "longitude", action: "input->location-form#onLongitudeChange" } 
            %>
            <!--end::Input-->
            <div class="fv-plugins-message-container invalid-feedback"></div>
          </div>
        </div>

        <div class="row mb-7">
          <div class="col-6 fv-plugins-icon-container">
            <!--begin::Label-->
            <label class="fs-6 fw-bold mb-2 required">Expected Mbps Up</label>
            <!--end::Label-->
            <!--begin::Input-->
            <%= form.text_field :expected_mbps_up, class: "form-control form-control-solid" %>
            <!--end::Input-->
            <div class="fv-plugins-message-container invalid-feedback"></div>
          </div>

          <div class="col-6 fv-plugins-icon-container">
            <!--begin::Label-->
            <label class="fs-6 fw-bold mb-2 required">Expected Mbps Down</label>
            <!--end::Label-->
            <!--begin::Input-->
            <%= form.text_field :expected_mbps_down, class: "form-control form-control-solid" %>
            <!--end::Input-->
            <div class="fv-plugins-message-container invalid-feedback"></div>
          </div>
        </div>
      </div>
      <div class="col-lg-6 mb-10 mb-lg-0">
        <div style="height: 300px;" data-location-form-target="map" data-action="modal:shown->location#display" data-controller="location" data-location-latitude-value="<%= @location.latitude %>" data-location-longitude-value="<%= @location.longitude %>"></div>
      </div>
    </div>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Cancel</button>
    <%= form.submit submit_name, class: "btn btn-primary" %>
  </div>
<% end %>
